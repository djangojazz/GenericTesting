<Application x:Class="Application"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="clr-namespace:VB_MVVM_Tester"
    StartupUri="Tester.xaml">
  <Application.Resources>
    <LinearGradientBrush x:Key="brushMainBoard" EndPoint="0.5,1" StartPoint="0.5,0">
      <GradientStop Color="#FF0C1526" Offset="1"/>
      <GradientStop Color="#FF347F71"/>
    </LinearGradientBrush>
    <LinearGradientBrush x:Key="brushLegendCustomDataGrid" EndPoint="0.5,1" StartPoint="0.5,0">
      <GradientStop Color="#FFE8E8E8" Offset="1"/>
      <GradientStop Color="#F9CBAF73" Offset="0.35"/>
      <GradientStop Color="#FFCB9D3B" Offset="0.837"/>
      <GradientStop Color="#E5AAA986"/>
    </LinearGradientBrush>
    <LinearGradientBrush x:Key="brushTextCustomDataGrid" EndPoint="0.5,1" StartPoint="0.5,0">
      <GradientStop Color="White" Offset="1"/>
      <GradientStop Color="#F9A08860" Offset="0.273"/>
      <GradientStop Color="#FFFFEBC6" Offset="0.813"/>
      <GradientStop Color="#E5F1EADE"/>
    </LinearGradientBrush>

    <DataTemplate x:Key ="marqueeControl">
      <StackPanel Orientation="Horizontal" x:Name="stack">
        <StackPanel.Resources>
          <local:NegatingConverter x:Key="NegatingConverter" />
          <Storyboard x:Key="slide">
            <DoubleAnimation From="0" To="{Binding Width, ElementName=canvas, Converter={StaticResource NegatingConverter}}" Duration="{Binding MarqueeTimeSpan}"
                      Storyboard.TargetProperty="X"
                      Storyboard.TargetName="thing"
                      RepeatBehavior="Forever"/>
          </Storyboard>
        </StackPanel.Resources>
        <StackPanel.RenderTransform>
          <TranslateTransform x:Name="thing" />
        </StackPanel.RenderTransform>
        <StackPanel.Triggers>
          <EventTrigger RoutedEvent="StackPanel.Loaded">
            <BeginStoryboard Storyboard="{StaticResource slide}" />
          </EventTrigger>
          <EventTrigger RoutedEvent="StackPanel.SizeChanged">
            <BeginStoryboard Storyboard="{StaticResource slide}" />
          </EventTrigger>
        </StackPanel.Triggers>
        <Canvas x:Name="canvas" Width="{Binding ActualWidth, ElementName=stack}">
          <TextBlock Text="{Binding MarqueeText}" FontSize="25"  x:Name="textToScroll" Canvas.Left="0"/>
          <TextBlock Text="{Binding Text, ElementName=textToScroll}" FontSize="25" Canvas.Left="{Binding Width, ElementName=canvas}"/>
        </Canvas>
      </StackPanel>
    </DataTemplate>
  </Application.Resources>
  
</Application>
